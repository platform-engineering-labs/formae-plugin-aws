/*
 * Â© 2025 Platform Engineering Labs Inc.
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

module aws.ec2.vpc

import "@formae/formae.pkl"
import "../aws.pkl"

const type = "AWS::EC2::Subnet"

typealias HostNameType = "ip-name"|"resource-name"

@aws.SubResourceHint
open class PrivateDnsNameOptionsOnLaunch extends formae.SubResource {
    enableResourceNameDnsAAAARecord: Boolean?
    enableResourceNameDnsARecord: Boolean?
    hostnameType: HostNameType?
}

open class SubnetResolvable extends formae.Resolvable {

    hidden type = module.type

    hidden id: SubnetResolvable = (this) {
        property = "SubnetId"
    }

    hidden subnetId: SubnetResolvable = (this) {
        property = "SubnetId"
    }

    hidden availabilityZone: SubnetResolvable = (this) {
        property = "AvailabilityZone"
    }

    hidden vpcId: SubnetResolvable = (this) {
        property = "VpcId"

    }
}

@aws.ResourceHint {
    type = module.type
    identifier = "SubnetId"
    parent = "AWS::EC2::VPC"
    listParam = new formae.ListProperty { parentProperty = "VpcId" listParameter = "VpcId" }
}
open class Subnet extends formae.Resource {

    @aws.FieldHint
    assignIpv6AddressOnCreation: Boolean? = false

    @aws.FieldHint{createOnly = true}
    availabilityZone: aws.AvailabilityZone?

    @aws.FieldHint{createOnly = true}
    availabilityZoneId: String?

    @aws.FieldHint{createOnly = true}
    cidrBlock: String?

    @aws.FieldHint
    enableDns64: Boolean? = false

    @aws.FieldHint{writeOnly = true}
    enableLniAtDeviceIndex: Int?

    @aws.FieldHint{
        createOnly = true
        writeOnly = true
    }
    ipv4IpamPoolId: String?

    @aws.FieldHint{
        createOnly = true
        writeOnly = true
    }
    ipv4NetmaskLength: Int?

    @aws.FieldHint{createOnly = true}
    ipv6CidrBlock: String?

    @aws.FieldHint{
        createOnly = true
        writeOnly = true
    }
    ipv6IpamPoolId: String?

    @aws.FieldHint{createOnly = true}
    ipv6Native: Boolean?

    @aws.FieldHint{
        createOnly = true
        writeOnly = true
    }
    ipv6NetmaskLength: Int?

    @aws.FieldHint
    mapPublicIpOnLaunch: Boolean? = false

    @aws.FieldHint{createOnly = true}
    outpostArn: String?

    @aws.FieldHint
    privateDnsNameOptionsOnLaunch: PrivateDnsNameOptionsOnLaunch?

    @aws.FieldHint {
        updateMethod = "EntitySet"
        indexField = "Key"
    }
    tags: Listing<aws.Tag>

    @aws.FieldHint{createOnly = true}
    vpcId: String|formae.Resolvable

    local parent = this

    hidden res: SubnetResolvable = new {
        label = parent.label
        stack = parent.stack?.label
    }
}